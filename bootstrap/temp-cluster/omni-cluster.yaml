kind: Cluster
name: talos-temp
kubernetes:
  # renovate: datasource=docker depName=ghcr.io/siderolabs/kubelet
  version: v1.34.2
talos:
  # renovate: datasource=docker depName=ghcr.io/siderolabs/installer
  version: v1.11.5
features:
  enableWorkloadProxy: true
  useEmbeddedDiscoveryService: true
  backupConfiguration:
    interval: 24h
patches:
  - file: ../global/machine-file.yaml
  - file: ../global/machine-kubelet.yaml
  - file: ../global/machine-network.yaml
  - file: ../global/machine-sysctls.yaml
  - file: ../global/machine-time.yaml
systemExtensions:
  - siderolabs/util-linux-tools
---
kind: ControlPlane
machines:
  - 4f0f1578-1849-48af-ae41-50b10212a191 # mini-talos-01
  - a9bc5b76-59d2-4281-97bd-37cf0c320ea0 # mini-talos-02
  - fa4df0b9-6d3b-4194-9e38-4ceec7b7f379 # mini-talos-03
patches:
  - file: ../controller/cluster-patch.yaml
  - name: patch-label
    inline:
      machine:
        nodeLabels:
          role: master
# ---
# kind: Workers
# machines:
#   - 33303734-3966-3030-3966-346234636131 # turing-01
#   - 64306566-3266-6634-3566-346632363063 # turing-03
#   - 30303031-3030-3030-6232-353461303639 # turing-04 (CM4)
# patches:
#   - name: patch-label
#     inline:
#       machine:
#         nodeLabels:
#           role: worker
---
kind: Machine
# mini-talos-01
name: 4f0f1578-1849-48af-ae41-50b10212a191
install:
  disk: /dev/sda
systemExtensions:
  - siderolabs/qemu-guest-agent
---
kind: Machine
# mini-talos-02
name: a9bc5b76-59d2-4281-97bd-37cf0c320ea0
install:
  disk: /dev/sda
systemExtensions:
  - siderolabs/qemu-guest-agent
---
kind: Machine
# mini-talos-03
name: fa4df0b9-6d3b-4194-9e38-4ceec7b7f379
install:
  disk: /dev/sda
systemExtensions:
  - siderolabs/qemu-guest-agent
# ---
# kind: Machine
# # turing-01
# name: 33303734-3966-3030-3966-346234636131
# install:
#   disk: /dev/disk/by-id/nvme-WDC_WDS500G2B0C-00PXH0_210541801953
# systemExtensions:
#   - siderolabs/gasket-driver
# ---
# kind: Machine
# # turing-03
# name: 64306566-3266-6634-3566-346632363063
# install:
#   disk: /dev/disk/by-id/nvme-WDC_WDS500G2B0C-00PXH0_210541802916
# ---
# kind: Machine
# # turing-04 (CM4)
# name: 30303031-3030-3030-6232-353461303639
# install:
#   disk: /dev/sda # model: Flash Drive FIT
